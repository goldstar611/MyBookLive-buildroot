https://lists.ozlabs.org/pipermail/linuxppc-dev/2017-September/164096.html
---
 arch/powerpc/kernel/setup-common.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff -ruN linux-vanilla-4.9.86/arch/powerpc/kernel/setup-common.c linux-4.9.86/arch/powerpc/kernel/setup-common.c
--- linux-vanilla-4.9.86/arch/powerpc/kernel/setup-common.c	2018-03-03 03:23:29.000000000 -0600
+++ linux-4.9.86/arch/powerpc/kernel/setup-common.c	2018-03-05 11:02:46.903159544 -0600
@@ -911,7 +911,8 @@
 	init_mm.end_code = (unsigned long) _etext;
 	init_mm.end_data = (unsigned long) _edata;
 	init_mm.brk = klimit;
-#ifdef CONFIG_PPC_64K_PAGES
+#if defined(CONFIG_PPC_64K_PAGES) && \
+    (defined(CONFIG_PPC_BOOK3S_64) || defined(CONFIG_PPC_BOOK3E_MMU))
 	init_mm.context.pte_frag = NULL;
 #endif
 #ifdef CONFIG_SPAPR_TCE_IOMMU
